<!DOCTYPE html>

<ion-view title="{{shop.shopName}}">
  <ion-content has-header="true" padding="true">
    <div class="list card pink">

      <div class="item item-avatar">
        <div class="productName">
          <div class="fullPrice  strike-center floatLeft">{{shop.shopAddress}}</div>
        </div>
        <div class="productDate dateLocation">{{shop.timeLimit|date:'至yy年MM月dd日'}}</div>
        <div class="addToCart">
          <button ng-class="favorites" ng-if="shop.numbers>0" ng-init="favoriteClass()" ng-click="changeClass()" ng-disabled="disableClick.value">{{favoritesText}}</button>
          <button ng-class="favorites" ng-if="shop.numbers<=0">没有剩余</button>
        </div>

      </div>

      <div class="item item-body">
        <img class="full-image" src="{{shop.shopImage}}">
        <p font>

        <div>优惠详情:{{shop.productDetail}}</div>
        <div>登录店家:{{shop.shopName}}</div>

        </p>
      <p>
        <!--<a href="#" class="subdued font">1 顶</a>-->
        <a href="#" class="subdued font">评价数:{{commentLength}}</a>
        <a href="#" class="subdued font">平均评分:{{averageRate}}</a>

      </p>
    </div>


    <div class="item tabs tabs-secondary tabs-icon-left" ng-click="changeShowComment()">
      <a class="tab-item" style = "font-size: 18px" >
        <i class="icon ion-chatbox"></i>
        评价
      </a>
    </div>
    <div ng-if="showComment">
      <rating data-ng-model="rate.value" max="max"></rating>评分:{{rate.value}}
      <input class="comment" type="text" ng-model="comment.comment">
      <button ng-click="submitComment()">提交</button>
    </div>
    <div ng-repeat = "xxx in comment | orderBy : '-date'">
      <div>{{xxx.title}}  评分:{{xxx.rate.value}}</div>
      <div>{{xxx.username}}  {{xxx.date|date:'yyyy年MM月dd日HH时mm分'}}</div>
    </div>
    </div>
    
  <div class=" bordLine  " collection-repeat="item in items | orderBy :'-id'">
    <a href="#/tab/shop-detail-item/{{item._id}}" class=" item item-thumbnail-left borderRadius5">
      <img class="product_image" ng-src="{{ item.image }}">
      <div lang="zh-cn" class="category" ng-if="item.numbers>0">剩{{item.numbers}}</div>
      <div lang="zh-cn" class="category" ng-if="item.numbers<=0">没有剩余</div>
      <div lang="zh-cn" class="category ion-heart" ng-if="find(item) ">已领</div>
      <ul>
        <li  lang="zh-cn" class="productName">{{item.name}}</li>
        <li  lang="zh-cn" class="productIntroduction">{{item.productIntroduction}}</li>
        <li  lang="zh-cn">
          <div class = "discountPrice floatLeft">{{item.discountPrice}}</div>
          <div class="fullPrice  strike-center floatLeft">{{item.fullPrice}}</div>
          <div class="productDate floatRight">{{item.timeLimit|date:'至yy年MM月dd日'}}</div>
        </li>
      </ul>
    </a>
  </div>

  </ion-content>
</ion-view>
